<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>椭圆</title>
</head>
<body>
<canvas width="400px" height="300px" style="width: 400px;height: 300px;background-color: #999999"></canvas>
<script src="dat.gui.min.js"></script>
<script src="require.min.js"></script>
<script>
    require(['xesMath'], function (xesMath) {
        var canvas = document.getElementsByTagName('canvas')[0];
        var context = canvas.getContext('2d');
        var canvasW = canvas.clientWidth;
        var canvasH = canvas.clientHeight;
        var data = {
            a: 50,
            _b: 50,
            h: 50,
            _k: 50,
            step: 0.1
        };
        var oval = xesMath.getOval(data.h, data._k,data.a, data._b,  data.step);
        var pointer = oval.points;
        var gui = new dat.GUI();
        gui.add(data, 'a', -100, 100).step(1).onChange(onChange);
        gui.add(data, 'b', -100, 100).step(1).onChange(onChange);
        gui.add(data, 'h', -100, 100).step(1).onChange(onChange);
        gui.add(data, 'k', -100, 100).step(1).onChange(onChange);
        gui.add(data, 'step', 0.1, 3).step(0.1).onChange(onChange);

        onChange();

        function onChange() {
            context.setTransform(1, 0, 0, 1, 0, 0);
            context.clearRect(0, 0, canvasW, canvasH);
            context.translate(canvasW >> 1, canvasH >> 1);
            context.scale(1, -1);
            oval=xesMath.getOval(data.h, data._k,data.a, data._b,  data.step);
            pointer = oval.points;
            xesMath.drawAxis(context, canvasW - 10, canvasH - 10);
            xesMath.draw(context, pointer);

            if(oval._x.length>0) {
                oval._x[0]&&draw(xesMath.getCircle(oval._x[0], 0, 4, 0.1).points);
                oval._x[1]&&draw(xesMath.getCircle(oval._x[1], 0, 4, 0.1).points);
            }

            if(oval._y.length>0) {
                oval._y[0]&&draw(xesMath.getCircle(0,oval._y[0], 4, 0.1).points);
                oval._y[1]&&draw(xesMath.getCircle(0,oval._y[1], 4, 0.1).points);
            }
        }
        function fixedNumber(num) {
            return num.toFixed(2);
        }

        function draw(points) {
            xesMath.draw(context, points);
        }
    })
</script>
</body>
</html>